import{l as h,o as p,c as m,a as s,v as k,t as v,x as j,z as P,y as L,b as x,f as U,d as l,e as V,E as D}from"./index-4sC0TyPp.js";const E={class:"space-y-6"},I={key:0,class:"space-y-4"},N={class:"flex flex-wrap items-center justify-between gap-4"},S={class:"flex items-center space-x-4"},G={class:"text-sm text-gray-500"},R={class:"flex items-center space-x-4"},O={class:"grid md:grid-cols-2 gap-4"},T=["src"],W={class:"text-sm text-gray-500 mt-1"},$=["src"],J={key:1,class:"text-sm text-gray-500 mt-1"},q={class:"text-green-500 ml-2"},A={__name:"ImageCompress",setup(H){const a=l(""),n=l(""),r=l(0),o=l(0),i=l(80),u=l("auto");let d=null;const _=t=>{const e=t.target.files[0];e&&f(e)},B=t=>{const e=t.dataTransfer.files[0];e&&e.type.startsWith("image/")&&f(e)},f=t=>{d=t,r.value=t.size,a.value=URL.createObjectURL(t),g()},y=()=>u.value!=="auto"?u.value:d?d.type==="image/png"?"image/png":d.type==="image/webp"?"image/webp":"image/jpeg":"image/jpeg",g=()=>{if(!a.value)return;const t=new Image;t.onload=()=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0);const F=y();e.toBlob(w=>{n.value=URL.createObjectURL(w),o.value=w.size},F,i.value/100)},t.src=a.value};h(i,g),h(u,g);const C=V(()=>{if(!o.value||!r.value)return 0;const t=Math.round((1-o.value/r.value)*100);return t>0?t:0}),b=t=>t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/1024/1024).toFixed(2)+" MB",M=()=>{const t=document.createElement("a");t.href=n.value;const e=y().split("/")[1];t.download=`compressed.${e==="jpeg"?"jpg":e}`,t.click(),D.success("下载成功")},z=()=>{a.value="",n.value="",r.value=0,o.value=0,d=null};return(t,e)=>(p(),m("div",E,[s("div",{class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-all cursor-pointer",onClick:e[0]||(e[0]=c=>t.$refs.fileInput.click()),onDragover:e[1]||(e[1]=k(()=>{},["prevent"])),onDrop:k(B,["prevent"])},[s("input",{ref:"fileInput",type:"file",accept:"image/*",multiple:"",onChange:_,class:"hidden"},null,544),e[4]||(e[4]=s("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e[5]||(e[5]=s("p",{class:"text-gray-600"},"点击或拖拽上传图片",-1)),e[6]||(e[6]=s("p",{class:"text-sm text-gray-400 mt-1"},"支持 JPG, PNG, WebP 格式，可批量处理",-1))],32),a.value?(p(),m("div",I,[s("div",N,[s("div",S,[s("span",G,"压缩质量: "+v(i.value)+"%",1),j(s("input",{"onUpdate:modelValue":e[2]||(e[2]=c=>i.value=c),type:"range",min:"10",max:"100",class:"w-32"},null,512),[[P,i.value]])]),s("div",R,[e[8]||(e[8]=s("span",{class:"text-sm text-gray-500"},"输出格式:",-1)),j(s("select",{"onUpdate:modelValue":e[3]||(e[3]=c=>u.value=c),class:"px-3 py-1 border rounded-lg text-sm"},[...e[7]||(e[7]=[s("option",{value:"auto"},"保持原格式",-1),s("option",{value:"image/jpeg"},"JPG",-1),s("option",{value:"image/png"},"PNG",-1),s("option",{value:"image/webp"},"WebP",-1)])],512),[[L,u.value]])])]),s("div",O,[s("div",null,[e[9]||(e[9]=s("div",{class:"text-sm font-medium text-gray-700 mb-2"},"原图",-1)),s("img",{src:a.value,class:"w-full rounded-lg border"},null,8,T),s("div",W,"大小: "+v(b(r.value)),1)]),s("div",null,[e[10]||(e[10]=s("div",{class:"text-sm font-medium text-gray-700 mb-2"},"压缩后",-1)),n.value?(p(),m("img",{key:0,src:n.value,class:"w-full rounded-lg border"},null,8,$)):x("",!0),o.value?(p(),m("div",J,[U(" 大小: "+v(b(o.value))+" ",1),s("span",q,"节省 "+v(C.value)+"%",1)])):x("",!0)])]),s("div",{class:"flex justify-center space-x-4"},[s("button",{onClick:M,class:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all"}," 下载压缩图片 "),s("button",{onClick:z,class:"px-6 py-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-all"}," 清空 ")])])):x("",!0)]))}};export{A as default};
