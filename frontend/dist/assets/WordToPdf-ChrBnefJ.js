import{o as i,c as d,a as t,v as p,t as u,b as f,d as c,B as h}from"./index-4sC0TyPp.js";const b={class:"space-y-6"},y={key:0,class:"space-y-4"},k={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},w={class:"flex items-center space-x-3"},_={class:"font-medium text-gray-800"},B={class:"text-sm text-gray-500"},D=["disabled"],C={key:0,class:"p-4 bg-green-50 rounded-lg"},F={class:"flex items-center justify-between"},V=["href"],M={__name:"WordToPdf",setup(j){const o=c(null),r=c(!1),n=c(""),v=s=>{const e=s.target.files[0];e&&(o.value=e)},g=s=>{const e=s.dataTransfer.files[0];e&&(e.name.endsWith(".doc")||e.name.endsWith(".docx"))&&(o.value=e)},m=s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":(s/1024/1024).toFixed(2)+" MB",x=async()=>{var e,l;if(!o.value)return;r.value=!0;const s=new FormData;s.append("document",o.value);try{const a=await h.post("/api/pdf/word-to-pdf",s);n.value=a.data.path}catch(a){alert("转换失败: "+(((l=(e=a.response)==null?void 0:e.data)==null?void 0:l.error)||a.message))}finally{r.value=!1}};return(s,e)=>(i(),d("div",b,[t("div",{class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-all cursor-pointer",onClick:e[0]||(e[0]=l=>s.$refs.fileInput.click()),onDragover:e[1]||(e[1]=p(()=>{},["prevent"])),onDrop:p(g,["prevent"])},[t("input",{ref:"fileInput",type:"file",accept:".doc,.docx",onChange:v,class:"hidden"},null,544),e[2]||(e[2]=t("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[3]||(e[3]=t("p",{class:"text-gray-600"},"点击或拖拽上传 Word 文档",-1)),e[4]||(e[4]=t("p",{class:"text-sm text-gray-400 mt-1"},"支持 .doc, .docx 格式",-1))],32),o.value?(i(),d("div",y,[t("div",k,[t("div",w,[e[5]||(e[5]=t("svg",{class:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("div",null,[t("div",_,u(o.value.name),1),t("div",B,u(m(o.value.size)),1)])]),t("button",{onClick:x,disabled:r.value,class:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all disabled:bg-gray-400"},u(r.value?"转换中...":"转换为PDF"),9,D)]),n.value?(i(),d("div",C,[t("div",F,[e[6]||(e[6]=t("div",{class:"text-green-600"},"转换成功！",-1)),t("a",{href:n.value,download:"",class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all"}," 下载 PDF ",8,V)])])):f("",!0)])):f("",!0)]))}};export{M as default};
